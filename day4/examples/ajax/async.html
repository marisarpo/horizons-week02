<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <title>Horizons AJAX Async Example</title>
  </head>

  <body>

    <h1>AJAX Async Example</h1>

    <p>Use <a href="http://api.jquery.com/jquery.ajax/">$.ajax()</a> to fetch <a href="https://horizons-json-cors.s3.amazonaws.com/products.json">these products</a> in JavaScript on this page. Display their names and prices below as a bulleted list.</p>
    <p>
      The link above will respond with an array of urls. You need to asynchronously make AJAX requests to these links, and then sort the results in increasing price order (lowest price up top).
    </p>

    <div id="products">REPLACE me with the sorted list of products! My <code>id is "products"</code>.</div>

    <h2>Example output</h2>
    <ul>
      <li>Raspberry Pi, $33.53</li>
      <li>Amazon Echo, $179.99</li>
      <li>DJI Phantom 3, $416.59</li>
    </ul>

    <script src='https://code.jquery.com/jquery-2.2.4.min.js'></script>
    <script>

var test = [["Raspberry Pi", "$33.53"],[]]
var listItems = []

      $.ajax({
        //AJAX GOES WITHIN THE FIRST URL
        url: "https://horizons-json-cors.s3.amazonaws.com/products.json",
        success: function(resp) {
        //TAKE EACH OF THE ELEMENTS WITHIN THE URL
          resp.forEach(function(element) {
            console.log(element.url)
            //USE THESE IN AJAX AGAIN TO FIND ELEMENTS
            $.ajax({
              url: element.url,
              success: function(resp2) {
              //PUT THE ELEMENTS INTO AN ARRAY
              var arr = []
              arr.push(resp2.name)
              arr.push((resp2.priceCents)/100)
              //PUT THIS ARRAY INTO THE MASTER ARRAY
              listItems.push(arr)
              //IF AJAX HAS GONE THROUGH ALL THE ITEMS
              if(listItems.length === resp.length){
                  //SORT ARRAY SMALLEST TO LARGEST
                  for(i=0; i<listItems; i++) {

                  }

                $("#products").replaceWith('<ul class=newList ></ul>')

                  for(var i=0; i<listItems.length; i++) {
                    $(".newList").append(`<li>`+ listItems[i][0] + ", $" + listItems[i][1] + `</li>`)


                  }

              }

              }
            })
          })
        }
      })

    // $("#products").replaceWith(`<ul>
    //     <li>`+ test[0][0] + ", " + test[0][1]  +`</li>
    //     <li>Tea</li>
    //     <li>Milk</li>
    //   </ul>`)


    </script>
  </body>
</html>

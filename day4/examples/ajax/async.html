<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <title>Horizons AJAX Async Example</title>
  </head>

  <body>

    <h1>AJAX Async Example</h1>

    <p>Use <a href="http://api.jquery.com/jquery.ajax/">$.ajax()</a> to fetch <a href="https://horizons-json-cors.s3.amazonaws.com/products.json">these products</a> in JavaScript on this page. Display their names and prices below as a bulleted list.</p>
    <p>
      The link above will respond with an array of urls. You need to asynchronously make AJAX requests to these links, and then sort the results in increasing price order (lowest price up top).
    </p>

    <div id="products">REPLACE me with the sorted list of products! My <code>id is "products"</code>.</div>

    <h2>Example output</h2>
    <ul>
      <li>Raspberry Pi, $33.53</li>
      <li>Amazon Echo, $179.99</li>
      <li>DJI Phantom 3, $416.59</li>
    </ul>

    <script src='https://code.jquery.com/jquery-2.2.4.min.js'></script>
    <script>
      // YOUR CODE HERE
      //firday material
      $.ajax({
         url:"https://horizons-json-cors.s3.amazonaws.com/products.json",
         
         success: function(response){
             $.ajax({  
  //this is nested in the success of first ajax, so won't run unless the first success
             var emptyArr = [];
             response.forEach(function(urlObject){
               $.ajax({
                 url: urlObject.url,
                 success:function(response2){
                    emptyArr.push(response2);
                    if(emptyArr.length === responese.length){


                    }
                 }
               })
             })


               url: response[0].url,
               success:function(response2){
                  
               }

             })

         }
       })

      console.log("Hey") 
      //this is printed out bef first ajax finish because ajax is asynx



      //my own attemp
      $.ajax({
         url:"https://horizons-json-cors.s3.amazonaws.com/products.json",
         
         success: function(data){
            var arr = [];
            for(var i = 0; i<data.length;i++){
              arr.push(data[i]['url'])
            } //create an arr of ['url','url',...]

            var arrProducts = [];

            for(var i=0;i<arr.length;i++){
              (function(i){
                $.ajax({
                  url: arr[i],
                  success: function(obj){
                      var product = [obj.name, " $"+obj.priceCents/100];
                      $('#products').remove();
                     
                      arrProducts.push(product);
                      
                      if(i===arr.length-1){

                        // console.log(arrProducts[0][0]);

                        var sortedArr = arrProducts.sort(function(a,b){
                          a[1].substring
                          if(a[1]<b[1]){
                            return -1;
                            parseFloat
                          }      
                          return 1;
                        });     
                        console.log(sortedArr)
                      }
                      
                      // for
                       // $('body p').eq(1).after($('<li>').text(arrProducts[i]));
                      // for(var i = 0;i<arr.length;i++){
                      //   $('body p').eq(1).after($('<li>').text(sortedArr[i]));
                      // }

                      // console.log(arrObj);
                  }
                })   //INNER AJAX       
              })(i);             
            }

         }
     
      })//OUTER AJAX

      // $('body p').eq(1).sort(function(a,b){
      //   return a-b;
      // })

    </script>
  </body>
</html>
